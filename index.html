<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—É—Ä–Ω–∏—Ä–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bottom-nav-height: 56px;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            padding: 0;
            margin: 0;
            color: var(--tg-theme-text-color, #000000);
            background-color: var(--tg-theme-bg-color, #ffffff);
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            padding: 0;
            margin: 0;
            padding-bottom: var(--bottom-nav-height);
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        /* –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è */
        .auth-container {
            display: none;
            padding: 20px;
        }

        .loader {
            text-align: center;
            padding: 30px 0;
        }

        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: var(--tg-theme-button-color, #3390ec);
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .button {
            display: block;
            width: 100%;
            padding: 12px 0;
            background-color: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            text-align: center;
            margin-bottom: 10px;
        }

        .card {
            background-color: var(--tg-theme-secondary-bg-color, #f0f0f0);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .error-message {
            color: #e53935;
            background-color: rgba(229, 57, 53, 0.1);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: none;
        }

        /* –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω */
        .main-container {
            display: none;
        }

        /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å –ø–æ–∏—Å–∫–∞ */
        .search-bar {
            padding: 15px;
            display: flex;
            align-items: center;
            background-color: var(--tg-theme-bg-color, #ffffff);
            border-bottom: 1px solid var(--tg-theme-hint-color, rgba(0, 0, 0, 0.1));
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .search-input {
            flex: 1;
            padding: 10px 16px;
            border-radius: 20px;
            border: none;
            background-color: var(--tg-theme-secondary-bg-color, #f0f0f0);
            color: var(--tg-theme-text-color, #000000);
            font-size: 16px;
            margin-right: 10px;
        }

        .filter-button {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--tg-theme-secondary-bg-color, #f0f0f0);
            color: var(--tg-theme-text-color, #000000);
            border: none;
        }

        /* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç—É—Ä–Ω–∏—Ä–æ–≤ */
        .tournament-categories {
            display: flex;
            padding: 5px 15px 15px;
            background-color: var(--tg-theme-bg-color, #ffffff);
            position: sticky;
            top: 70px;
            z-index: 9;
        }

        .category-button {
            flex: 1;
            padding: 8px 12px;
            text-align: center;
            background-color: var(--tg-theme-secondary-bg-color, #f0f0f0);
            border: none;
            color: var(--tg-theme-text-color, #000000);
            border-radius: 20px;
            margin: 0 5px;
            font-weight: 500;
            font-size: 14px;
        }

        .category-button.active {
            background-color: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #ffffff);
        }

        /* –°–ø–∏—Å–æ–∫ —Ç—É—Ä–Ω–∏—Ä–æ–≤ */
        .tournaments-list {
            padding: 0 15px;
        }

        .tournament-card {
            background-color: var(--tg-theme-secondary-bg-color, #f0f0f0);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .tournament-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .tournament-time {
            font-size: 14px;
            color: var(--tg-theme-hint-color, #999);
            margin-bottom: 15px;
        }

        .tournament-players {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .player {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 40%;
        }

        .player-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--tg-theme-bg-color, #fff);
            margin-bottom: 5px;
            overflow: hidden;
        }

        .player-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .player-name {
            font-size: 14px;
            font-weight: 500;
            text-align: center;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .vs {
            font-size: 18px;
            font-weight: bold;
            color: var(--tg-theme-hint-color, #999);
        }

        /* –ü—Ä–æ—Ñ–∏–ª—å */
        .profile-container {
            padding: 20px;
            display: none;
        }

        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: var(--tg-theme-secondary-bg-color, #f0f0f0);
            margin-right: 15px;
            overflow: hidden;
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-info h2 {
            margin: 0 0 5px;
            font-size: 20px;
        }

        .profile-info p {
            margin: 0;
            color: var(--tg-theme-hint-color, #999);
            font-size: 14px;
        }

        .profile-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .stat-card {
            flex: 1;
            background-color: var(--tg-theme-secondary-bg-color, #f0f0f0);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            margin: 0 5px;
        }

        .stat-card:first-child {
            margin-left: 0;
        }

        .stat-card:last-child {
            margin-right: 0;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--tg-theme-hint-color, #999);
        }

        /* –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--bottom-nav-height);
            background-color: var(--tg-theme-bg-color, #ffffff);
            display: flex;
            border-top: 1px solid var(--tg-theme-hint-color, rgba(0, 0, 0, 0.1));
            z-index: 100;
        }

        .nav-tab {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--tg-theme-hint-color, #999);
            font-size: 12px;
            text-decoration: none;
        }

        .nav-tab.active {
            color: var(--tg-theme-button-color, #3390ec);
        }

        .nav-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }

        .placeholder-avatar {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--tg-theme-button-color, #3390ec);
            color: white;
            font-weight: bold;
            font-size: 24px;
        }

        /* –î–ª—è –ø—É—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            text-align: center;
            color: var(--tg-theme-hint-color, #999);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .empty-state-text {
            font-size: 16px;
            max-width: 250px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div id="loader" class="loader">
            <div class="spinner"></div>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...</p>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –æ—à–∏–±–∫–∏ -->
        <div id="error-message" class="error-message">
            –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
        <div id="auth-container" class="auth-container">
            <div class="header">
                <h1>–¢—É—Ä–Ω–∏—Ä–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h1>
            </div>
            <div class="card">
                <p>–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–π—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ Telegram.</p>
                <p>–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.</p>
            </div>
            <button class="button" id="auth-button">–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</button>
        </div>

        <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω -->
        <div id="main-container" class="main-container">
            <!-- –≠–∫—Ä–∞–Ω —Ç—É—Ä–Ω–∏—Ä–æ–≤ -->
            <div id="tournaments-screen" class="tournaments-screen">
                <!-- –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ -->
                <div class="search-bar">
                    <input type="text" class="search-input" id="search-tournaments" placeholder="–ü–æ–∏—Å–∫ —Ç—É—Ä–Ω–∏—Ä–æ–≤...">
                    <button class="filter-button">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4 6H20M7 12H17M9 18H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>

                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç—É—Ä–Ω–∏—Ä–æ–≤ -->
                <div class="tournament-categories">
                    <button class="category-button active" data-category="live">LIVE</button>
                    <button class="category-button" data-category="participating">–£—á–∞—Å—Ç–≤—É—é</button>
                    <button class="category-button" data-category="participated">–£—á–∞—Å—Ç–≤–æ–≤–∞–ª</button>
                </div>

                <!-- –°–ø–∏—Å–æ–∫ —Ç—É—Ä–Ω–∏—Ä–æ–≤ -->
                <div class="tournaments-list" id="tournaments-list">
                    <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç —Ç—É—Ä–Ω–∏—Ä—ã -->
                </div>
            </div>

            <!-- –≠–∫—Ä–∞–Ω —Å–æ–∑–¥–∞–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞ -->
            <div id="create-tournament-screen" class="profile-container" style="display: none;">
                <div class="header">
                    <h1>–°–æ–∑–¥–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞</h1>
                </div>
                
                <div class="card">
                    <div style="margin-bottom: 15px;">
                        <label for="tournament-name" style="display: block; margin-bottom: 5px; font-weight: 500;">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞</label>
                        <input type="text" id="tournament-name" class="search-input" style="width: 100%; box-sizing: border-box; margin-bottom: 15px;" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞">
                        
                        <label for="game-select" style="display: block; margin-bottom: 5px; font-weight: 500;">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</label>
                        <select id="game-select" style="width: 100%; padding: 10px; border-radius: 8px; border: none; background-color: var(--tg-theme-secondary-bg-color, #f0f0f0); margin-bottom: 15px; color: var(--tg-theme-text-color, #000000);">
                            <option value="chess">–®–∞—Ö–º–∞—Ç—ã</option>
                            <option value="checkers">–®–∞—à–∫–∏</option>
                            <option value="tennis">–¢–µ–Ω–Ω–∏—Å</option>
                            <option value="football">–§—É—Ç–±–æ–ª</option>
                            <option value="basketball">–ë–∞—Å–∫–µ—Ç–±–æ–ª</option>
                        </select>
                        
                        <label for="coins-input" style="display: block; margin-bottom: 5px; font-weight: 500;">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç</label>
                        <input type="number" id="coins-input" class="search-input" style="width: 100%; box-sizing: border-box; margin-bottom: 15px;" placeholder="–£–∫–∞–∂–∏—Ç–µ —Å—Ç–∞–≤–∫—É –≤ –º–æ–Ω–µ—Ç–∞—Ö" min="10" step="10" value="100">
                        
                        <label for="time-select" style="display: block; margin-bottom: 5px; font-weight: 500;">–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞</label>
                        <select id="time-select" style="width: 100%; padding: 10px; border-radius: 8px; border: none; background-color: var(--tg-theme-secondary-bg-color, #f0f0f0); color: var(--tg-theme-text-color, #000000);">
                            <option value="5">–ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç</option>
                            <option value="15">–ß–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç</option>
                            <option value="30">–ß–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç</option>
                            <option value="60">–ß–µ—Ä–µ–∑ 1 —á–∞—Å</option>
                            <option value="120">–ß–µ—Ä–µ–∑ 2 —á–∞—Å–∞</option>
                        </select>
                    </div>
                </div>
                
                <!-- –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫—É, –Ω–æ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ -->
                <button id="create-tournament-button" class="button" onclick="createTournament()" disabled style="opacity: 0.5; cursor: not-allowed; transition: all 0.3s ease;">
                    –°–æ–∑–¥–∞—Ç—å —Ç—É—Ä–Ω–∏—Ä
                </button>
                
                <!-- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞ -->
                <script type="text/javascript">
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º—É –ø—Ä–∏ –ª—é–±–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª–µ–π
                    document.getElementById('tournament-name').addEventListener('input', validateForm);
                    document.getElementById('game-select').addEventListener('change', validateForm);
                    document.getElementById('coins-input').addEventListener('input', validateForm);
                    document.getElementById('time-select').addEventListener('change', validateForm);
                    
                    // –§—É–Ω–∫—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º—ã
                    function validateForm() {
                        const name = document.getElementById('tournament-name').value;
                        const coins = document.getElementById('coins-input').value;
                        const button = document.getElementById('create-tournament-button');
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π
                        if (name && name.trim() !== '' && coins && coins.trim() !== '' && parseInt(coins) >= 10) {
                            // –í–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É
                            button.disabled = false;
                            button.style.opacity = '1';
                            button.style.cursor = 'pointer';
                        } else {
                            // –í—ã–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É
                            button.disabled = true;
                            button.style.opacity = '0.5';
                            button.style.cursor = 'not-allowed';
                        }
                    }
                    
                    // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞
                    async function createTournament() {
                        // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª–µ–π
                        const name = document.getElementById('tournament-name').value;
                        const game = document.getElementById('game-select').value;
                        const coins = document.getElementById('coins-input').value;
                        const time = document.getElementById('time-select').value;
                        
                        // –ï—â–µ —Ä–∞–∑ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π
                        if (!name || name.trim() === '') {
                            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞');
                            return false;
                        }
                        
                        if (!coins || isNaN(parseInt(coins)) || parseInt(coins) < 10) {
                            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç (–º–∏–Ω–∏–º—É–º 10)');
                            return false;
                        }

                        try {
                            const userData = getUserData();
                            const tournamentRequest = {
                                title: name,
                                game: game,
                                coins: parseInt(coins),
                                startTimeMinutesFromNow: parseInt(time),
                                userId: userData.id,
                                userName: userData.first_name + (userData.last_name ? ' ' + userData.last_name : '')
                            };

                            // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                            const headers = {
                                'Content-Type': 'application/json'
                            };

                            if (config.isTelegramWebView) {
                                headers['X-Telegram-Init-Data'] = tg.initData;
                            }

                            const response = await fetch(`${config.API_BASE_URL}/api/tournaments`, {
                                method: 'POST',
                                headers: headers,
                                body: JSON.stringify(tournamentRequest)
                            });

                            if (!response.ok) {
                                throw new Error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç—É—Ä–Ω–∏—Ä–∞');
                            }

                            const result = await response.json();
                            
                            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
                            alert(`–¢—É—Ä–Ω–∏—Ä —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω, –µ–≥–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä ${result.id}`);
                            
                            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è —Ñ–æ—Ä–º—ã
                            document.getElementById('tournament-name').value = '';
                            document.getElementById('coins-input').value = '100';
                            
                            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ø–∏—Å–∫—É —Ç—É—Ä–Ω–∏—Ä–æ–≤
                            document.getElementById('tournaments-screen').style.display = 'block';
                            document.getElementById('profile-screen').style.display = 'none';
                            document.getElementById('create-tournament-screen').style.display = 'none';
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ —Ç—É—Ä–Ω–∏—Ä–æ–≤
                            loadTournaments('live');
                            
                            // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –º–µ–Ω—é
                            const tabs = document.querySelectorAll('.nav-tab');
                            tabs.forEach(tab => {
                                if (tab.dataset.screen === 'tournaments') {
                                    tab.classList.add('active');
                                } else {
                                    tab.classList.remove('active');
                                }
                            });

                        } catch (error) {
                            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç—É—Ä–Ω–∏—Ä–∞:', error);
                            alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç—É—Ä–Ω–∏—Ä–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
                        }
                        
                        return false;
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
                    validateForm();
                </script>
            </div>

            <!-- –≠–∫—Ä–∞–Ω –ø—Ä–æ—Ñ–∏–ª—è -->
            <div id="profile-screen" class="profile-container">
                <div class="profile-header">
                    <div class="profile-avatar" id="profile-avatar">
                        <!-- –ê–≤–∞—Ç–∞—Ä -->
                    </div>
                    <div class="profile-info">
                        <h2 id="profile-name">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
                        <p id="profile-id">ID: 12345678</p>
                    </div>
                </div>

                <div class="profile-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="tournaments-count">0</div>
                        <div class="stat-label">–¢—É—Ä–Ω–∏—Ä–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="wins-count">0</div>
                        <div class="stat-label">–ü–æ–±–µ–¥</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="rating-value">0</div>
                        <div class="stat-label">–†–µ–π—Ç–∏–Ω–≥</div>
                    </div>
                </div>

                <button class="button" id="logout-button">–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</button>
            </div>
        </div>

        <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
        <div class="bottom-nav" id="bottom-nav">
            <a href="#" class="nav-tab active" data-screen="tournaments">
                <div class="nav-icon">üèÜ</div>
                <div>–¢—É—Ä–Ω–∏—Ä—ã</div>
            </a>
            <a href="#" class="nav-tab" data-screen="create-tournament">
                <div class="nav-icon" style="font-size: 28px; font-weight: bold;">+</div>
                <div>–°–æ–∑–¥–∞—Ç—å</div>
            </a>
            <a href="#" class="nav-tab" data-screen="profile">
                <div class="nav-icon">üë§</div>
                <div>–ü—Ä–æ—Ñ–∏–ª—å</div>
            </a>
        </div>
    </div>

    <script>
        // –û–±—ä—è–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤
        window.userCreatedTournaments = [];
        
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
        const ENV = {
            development: {
                API_BASE_URL: 'http://localhost:8080',
                isTelegramWebView: false
            },
            production: {
                API_BASE_URL: 'https://your-production-api.com', // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –ø—Ä–æ–¥–∞–∫—à–Ω URL
                isTelegramWebView: true
            }
        };

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
        const currentEnv = window.Telegram?.WebApp ? 'production' : 'development';
        const config = ENV[currentEnv];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Mini App
        let tg = window.Telegram?.WebApp;

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getUserData() {
            if (config.isTelegramWebView && tg) {
                // –í Telegram WebApp
                return {
                    id: tg.initDataUnsafe?.user?.id,
                    first_name: tg.initDataUnsafe?.user?.first_name,
                    last_name: tg.initDataUnsafe?.user?.last_name,
                    username: tg.initDataUnsafe?.user?.username,
                    photo_url: tg.initDataUnsafe?.user?.photo_url,
                    auth_date: tg.initDataUnsafe?.auth_date,
                    hash: tg.initDataUnsafe?.hash
                };
            } else {
                // –í —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
                return {
                    id: '12345678',
                    first_name: '–¢–µ—Å—Ç–æ–≤—ã–π',
                    last_name: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                    username: 'test_user',
                    photo_url: null
                };
            }
        }

        // –¢–µ–∫—É—â–∏–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        let currentCategory = 'live';
        let currentScreen = 'tournaments';
        let searchQuery = '';

        // –§—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è initData –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        function formatInitData(initData) {
            return Object.keys(initData)
                .filter(key => initData[key] !== undefined)
                .map(key => `${key}=${encodeURIComponent(initData[key])}`)
                .join('&');
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–Ω–∏—Ü–∏–∞–ª–æ–≤ –∏–∑ –∏–º–µ–Ω–∏
        function getInitials(name) {
            if (!name) return '?';
            const parts = name.split(' ');
            if (parts.length > 1) {
                return (parts[0][0] + parts[1][0]).toUpperCase();
            }
            return parts[0][0].toUpperCase();
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ HH:MM
        function getCurrentTime() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            return `${hours}:${minutes}`;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è –∏–≥—Ä—ã –ø–æ –∫–æ–¥—É
        function getGameName(gameCode) {
            const games = {
                'chess': '–®–∞—Ö–º–∞—Ç—ã',
                'checkers': '–®–∞—à–∫–∏',
                'tennis': '–¢–µ–Ω–Ω–∏—Å',
                'football': '–§—É—Ç–±–æ–ª',
                'basketball': '–ë–∞—Å–∫–µ—Ç–±–æ–ª'
            };
            
            return games[gameCode] || gameCode;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Ç—É—Ä–Ω–∏—Ä–∞—Ö
        async function getTournamentsData(category) {
            try {
                const userData = getUserData();
                let endpoint = `${config.API_BASE_URL}/api/tournaments`;
                
                switch(category) {
                    case 'live':
                        endpoint += '/active';
                        break;
                    case 'participating':
                    case 'participated':
                        endpoint += `/user/${userData.id}`;
                        break;
                }

                const headers = {};
                if (config.isTelegramWebView) {
                    headers['X-Telegram-Init-Data'] = tg.initData;
                }

                const response = await fetch(endpoint, { headers });
                if (!response.ok) {
                    throw new Error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ç—É—Ä–Ω–∏—Ä–æ–≤');
                }

                const tournaments = await response.json();
                return tournaments;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ç—É—Ä–Ω–∏—Ä–æ–≤:', error);
                return [];
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç—É—Ä–Ω–∏—Ä–æ–≤ –ø–æ –ø–æ–∏—Å–∫–æ–≤–æ–º—É –∑–∞–ø—Ä–æ—Å—É
        function filterTournaments(tournaments, query) {
            if (!query || query.trim() === '') {
                return tournaments;
            }
            
            query = query.toLowerCase().trim();
            
            return tournaments.filter(tournament => {
                // –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Ç—É—Ä–Ω–∏—Ä–∞
                if (tournament.title.toLowerCase().includes(query)) {
                    return true;
                }
                
                // –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∞–º –∏–≥—Ä–æ–∫–æ–≤
                if (tournament.player1.name.toLowerCase().includes(query) || 
                    tournament.player2.name.toLowerCase().includes(query)) {
                    return true;
                }
                
                return false;
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç—É—Ä–Ω–∏—Ä–æ–≤
        async function loadTournaments(category) {
            const tournamentsContainer = document.getElementById('tournaments-list');
            tournamentsContainer.innerHTML = '<div class="spinner"></div>';
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ —Ç—É—Ä–Ω–∏—Ä–∞—Ö
                let tournaments = await getTournamentsData(category);
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä –ø–æ–∏—Å–∫–∞
                if (searchQuery) {
                    tournaments = filterTournaments(tournaments, searchQuery);
                }
                
                // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç—É—Ä–Ω–∏—Ä–æ–≤
                if (tournaments.length === 0) {
                    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                    let emptyMessage = "–¢—É—Ä–Ω–∏—Ä—ã –≤ –¥–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç";
                    
                    if (searchQuery) {
                        emptyMessage = `–ü–æ –∑–∞–ø—Ä–æ—Å—É "${searchQuery}" –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ`;
                    }
                    
                    tournamentsContainer.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">üîç</div>
                            <div class="empty-state-text">${emptyMessage}</div>
                        </div>
                    `;
                } else {
                    // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç—É—Ä–Ω–∏—Ä–∞
                    tournaments.forEach(tournament => {
                        const tournamentCard = document.createElement('div');
                        tournamentCard.className = 'tournament-card';
                        tournamentCard.innerHTML = `
                            <div class="tournament-title">${tournament.title}</div>
                            <div class="tournament-time">
                                ${tournament.time}
                                ${tournament.coins ? ` ‚Ä¢ ${tournament.coins} –º–æ–Ω–µ—Ç` : ''}
                                ${tournament.game ? ` ‚Ä¢ ${getGameName(tournament.game)}` : ''}
                            </div>
                            <div class="tournament-players">
                                <div class="player">
                                    <div class="player-avatar">
                                        ${tournament.player1.avatar 
                                            ? `<img src="${tournament.player1.avatar}" alt="${tournament.player1.name}">` 
                                            : `<div class="placeholder-avatar">${getInitials(tournament.player1.name)}</div>`}
                                    </div>
                                    <div class="player-name">${tournament.player1.name}</div>
                                </div>
                                <div class="vs">VS</div>
                                <div class="player">
                                    <div class="player-avatar">
                                        ${tournament.player2.avatar 
                                            ? `<img src="${tournament.player2.avatar}" alt="${tournament.player2.name}">` 
                                            : `<div class="placeholder-avatar">${getInitials(tournament.player2.name)}</div>`}
                                    </div>
                                    <div class="player-name">${tournament.player2.name}</div>
                                </div>
                            </div>
                        `;
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
                        tournamentCard.addEventListener('click', () => {
                            alert(`–û—Ç–∫—Ä—ã—Ç—å —Ç—É—Ä–Ω–∏—Ä ${tournament.id}: ${tournament.title}`);
                        });
                        
                        tournamentsContainer.appendChild(tournamentCard);
                    });
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤:', error);
                tournamentsContainer.innerHTML = '<div class="error-message">–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</div>';
            } finally {
                document.getElementById('loader').style.display = 'none';
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç—É—Ä–Ω–∏—Ä–æ–≤
        function switchCategory(category) {
            currentCategory = category;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            const categoryButtons = document.querySelectorAll('.category-button');
            categoryButtons.forEach(button => {
                if (button.dataset.category === category) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            });
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç—É—Ä–Ω–∏—Ä—ã –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            loadTournaments(category);
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
        function showScreen(screen) {
            console.log('–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —ç–∫—Ä–∞–Ω:', screen);
            currentScreen = screen;
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
            document.getElementById('tournaments-screen').style.display = 'none';
            document.getElementById('profile-screen').style.display = 'none';
            document.getElementById('create-tournament-screen').style.display = 'none';
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —ç–∫—Ä–∞–Ω
            if (screen === 'tournaments') {
                document.getElementById('tournaments-screen').style.display = 'block';
            } else if (screen === 'profile') {
                document.getElementById('profile-screen').style.display = 'block';
            } else if (screen === 'create-tournament') {
                document.getElementById('create-tournament-screen').style.display = 'block';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É –≤ –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => {
                if (tab.dataset.screen === screen) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        async function checkAuth() {
            document.getElementById('loader').style.display = 'block';
            document.getElementById('auth-container').style.display = 'none';
            document.getElementById('main-container').style.display = 'none';
            document.getElementById('error-message').style.display = 'none';

            try {
                const userData = getUserData();
                
                if (config.isTelegramWebView) {
                    // –í Telegram WebApp –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω
                    loadMainScreen(userData);
                    tg.expand(); // –†–∞—Å—à–∏—Ä—è–µ–º –æ–∫–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                } else {
                    // –í —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É
                    const savedUser = localStorage.getItem('tg_user');
                    if (savedUser) {
                        loadMainScreen(JSON.parse(savedUser));
                    } else {
                        document.getElementById('auth-container').style.display = 'block';
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', error);
                document.getElementById('error-message').style.display = 'block';
                if (!config.isTelegramWebView) {
                    document.getElementById('auth-container').style.display = 'block';
                }
            } finally {
                document.getElementById('loader').style.display = 'none';
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
        function loadMainScreen(user) {
            // –°–Ω–∞—á–∞–ª–∞ —Å–∫—Ä—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏
            document.getElementById('loader').style.display = 'none';
            document.getElementById('error-message').style.display = 'none';
            document.getElementById('auth-container').style.display = 'none';
            document.getElementById('main-container').style.display = 'block';
            
            console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', user);
            
            try {
                // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                document.getElementById('profile-name').textContent = user.first_name + (user.last_name ? ' ' + user.last_name : '');
                document.getElementById('profile-id').textContent = 'ID: ' + user.id;
                
                const avatarContainer = document.getElementById('profile-avatar');
                
                // –ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è
                if (user.photo_url) {
                    avatarContainer.innerHTML = `<img src="${user.photo_url}" alt="Avatar">`;
                } else {
                    // –ï—Å–ª–∏ –Ω–µ—Ç —Ñ–æ—Ç–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª—ã
                    const initials = getInitials(user.first_name + (user.last_name ? ' ' + user.last_name : ''));
                    avatarContainer.innerHTML = `<div class="placeholder-avatar">${initials}</div>`;
                }
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                document.getElementById('tournaments-count').textContent = Math.floor(Math.random() * 20) + 5;
                document.getElementById('wins-count').textContent = Math.floor(Math.random() * 10) + 1;
                document.getElementById('rating-value').textContent = Math.floor(Math.random() * 1000) + 800;
                
                // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ —Ç—É—Ä–Ω–∏—Ä–æ–≤
                loadTournaments(currentCategory);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω —Ç—É—Ä–Ω–∏—Ä–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                showScreen('tournaments');
                
                console.log('–ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞:', error);
                // –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏, –≤—Å–µ —Ä–∞–≤–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω
                showScreen('tournaments');
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
        function logout() {
            localStorage.removeItem('tg_user');
            document.getElementById('main-container').style.display = 'none';
            document.getElementById('auth-container').style.display = 'block';
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
        document.getElementById('tournament-name')?.addEventListener('input', validateForm);
        document.getElementById('coins-input')?.addEventListener('input', validateForm);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–∏—Å–∫–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏
        document.getElementById('search-tournaments').addEventListener('input', function(e) {
            console.log('–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å:', e.target.value);
            searchQuery = e.target.value;
            loadTournaments(currentCategory);
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞
        document.querySelector('.filter-button').addEventListener('click', function() {
            console.log('–ù–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞');
            alert('–§—É–Ω–∫—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏');
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞ - –≤—Å—Ç—Ä–æ–µ–Ω –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ —Ç–µ–≥ –∫–Ω–æ–ø–∫–∏ —á–µ—Ä–µ–∑ onclick
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        document.getElementById('auth-button').addEventListener('click', authenticateWithServer);
        document.getElementById('logout-button').addEventListener('click', logout);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç—É—Ä–Ω–∏—Ä–æ–≤
        document.querySelectorAll('.category-button').forEach(button => {
            button.addEventListener('click', () => {
                switchCategory(button.dataset.category);
            });
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', (e) => {
                e.preventDefault();
                showScreen(tab.dataset.screen);
            });
        });

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        window.onerror = function(message, source, lineno, colno, error) {
            console.error('–ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞ JavaScript:', message, '–ò—Å—Ç–æ—á–Ω–∏–∫:', source, '–°—Ç—Ä–æ–∫–∞:', lineno);
            // –ù–µ –¥–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –∑–∞–≤–∏—Å–Ω—É—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–µ
            document.getElementById('loader').style.display = 'none';
            document.getElementById('main-container').style.display = 'block';
            showScreen('tournaments');
            return true;
        };
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π, —á—Ç–æ–±—ã –≤—Å–µ —Å–∫—Ä–∏–ø—Ç—ã —É—Å–ø–µ–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è
        setTimeout(function() {
            checkAuth();
        }, 500);
        
        // –í—ã–∑—ã–≤–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        setTimeout(function() {
            try {
                validateForm();
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º—ã:', e);
            }
        }, 1000);
    </script>
</body>
</html>
</html>